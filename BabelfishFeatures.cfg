#
# Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
# SPDX-License-Identifier: Apache-2.0
#------------------------------------------------------------------------------
#
# *** DO NOT EDIT THIS FILE MANUALLY! ***
#
#------------------------------------------------------------------------------
#
# Babelfish Features .cfg file 
# This file defines SQL features (not) supported by specific Babelfish versions
#
#------------------------------------------------------------------------------

# this must always be the first section:
[Babelfish for T-SQL]
valid_versions=1.0.0, 1.1.0, 1.2.0      # only Babelfish version numbers listed here can be referenced below
file_format=1                           # version number for format of this .cfg file. This is not expected to change much 
file_timestamp=Mar-2022                 # identifies the version of this file, together with the latest Babelfish version supported
                                        # format: dd-MON-yyyy or MON-yyyy

# Basic principle: 
#   - if a feature is not listed in this file, then it is supported by Babelfish
#   - features listed in this file are marked supported in a particular Babelfish version, 
#   - supported in a range of versions, or not supported at all
#   - by default, a feature in this file is calssified as 'not supported', unless it is 
#     indicated that it is supported in a particular Babelfish version
#   - a feature can also be classified as 'review_semantics' or 'review_performance', which 
#     indicates the user should consider the feature differently from that perspective
#     rather a supported/unsupported binary choice
#   - to use a '#' character as itself rather than as a comment delimiter, specify '##'
#

#--- values for classifying feature aspects -----------------------------------
#
#   Supported: when listed in a key 'supported-<version>='
#   NotSupported: when not listed in a key 'supported-<version>=', the default classification defaults to NotSupported
#
#   ReviewSemantics: a feature will be processed by Babelfish, but is recommend to review its semantics by the user, due to certain differences which Babelfish cannot compensate for
#   ReviewPerformance: a feature will be processed by Babelfish, but is recommend to be reviewed for possible performance implications
#   Ignored: a feature will be ignored by Babelfish, despite not actually being supported
#
#--- example section (commented out) ------------------------------------------
#
#	[FEATURE_A_EXAMPLE]
#   rule=grammar_rule_name      # grammar rule corresponding to this feature
#	                            # nothing specified: this feature is not currently supported                          
#	                            
#
#	[FEATURE_B_EXAMPLE]
#   rule=grammar_rule_name      # grammar rule corresponding to this feature
#	supported-1.0.0=ON          # value ON for this feature is supported in v.1.0 and later
#	                            # other values (like OFF) are not supported in v.1.0
#	                           
#	[FEATURE_C_EXAMPLE]
#   rule=grammar_rule_name      # grammar rule corresponding to this feature
#	supported-1.0.0=*           # all values for this feature are supported in v.1.0 and later
#
#
#	[FEATURE_D_EXAMPLE]
#   rule=grammar_rule_name      # grammar rule corresponding to this feature
#	list=value1,value2,value3   # only for features where all values need to be listed for validation (like @@variables): all values should be listed here, whether supported or not.
#	supported-1.0.0=value2      # value2 is supported in v.1.0 and later, others are not supported in 1.0
#	supported-1.1=value1        # value1 is supported in v.1.1 and later
#	supported-1.3-1.4=value3    # supported in version 1.3 and later until 1.4.0 (inclusive), but not 1.4.1 or later
#	supported-1.3-1.*=value4    # supported in 1.3 and later until 1.99999, but not 2.0 or later
#	supported-2.0=*             # all values are supported in v.2.0 and later
#	report_group=XYZ            # optional, for presentation: report this feature under category 'XYZ'
#
#
#	# feature with specific values of a particular argument: argument#1 = 'arg1', argument#2 = 'arg2', etc.
#	[FEATURE_E_EXAMPLE]
#   rule=grammar_rule_name          # grammar rule corresponding to this feature
#	supported-1.0.0=arg1=value1     # for argument #1 of FEATURE_E_EXAMPLE, value1 is supported in v.1.0 and later (other values are not supported)
#	supported-1.1=arg1=value2       # for argument #1 of FEATURE_E_EXAMPLE, value2 is supported in v.1.1 and later
#	supported-1.3-1.*=arg1=value3   # for argument #1 of FEATURE_E_EXAMPLE, value3 is supported in v.1.3-1.x 
#	report_group-ABC=value4         # optional, for presentation: report value4 under category 'ABC' 
#	report_group=XYZ                # optional, for presentation: report any value for this feature under category 'XYZ'; value-specific keys like 'report_group-ABC=' take precendence over this key
#
#
# 	# by default, if a feature is not marked as supported, it is classified as 'NotSupported',
#   # but this key overrides the default
#	default_classification=ReviewSemantics 
#
#--- end example section ---------------------------------------------------------


#--- Babelfish features ----------------------------------------------------------

#--- functions/datatypes -----

[@@variable]
rule=expression
list=@@CONNECTIONS,@@CPU_BUSY,@@CURSOR_ROWS,@@DATEFIRST,@@DBTS,@@ERROR,@@FETCH_STATUS,@@IDENTITY,@@IDLE,@@IO_BUSY,@@LANGID,@@LANGUAGE,@@LOCK_TIMEOUT,@@MAX_CONNECTIONS,@@MAX_PRECISION,@@NESTLEVEL,@@OPTIONS,@@PACKET_ERRORS,@@PACK_RECEIVED,@@PACK_SENT,@@PROCID,@@REMSERVER,@@ROWCOUNT,@@SERVERNAME,@@SERVICENAME,@@SPID,@@TEXTSIZE,@@TIMETICKS,@@TOTAL_ERRORS,@@TOTAL_READ,@@TOTAL_WRITE,@@TRANCOUNT,@@VERSION,@@MICROSOFTVERSION
supported-1.0.0=@@VERSION,@@SPID,@@ROWCOUNT,@@TRANCOUNT,@@IDENTITY,@@ERROR,@@FETCH_STATUS,@@MAX_PRECISION,@@SERVERNAME,@@DATEFIRST,@@OPTIONS
supported-1.1.0=@@MICROSOFTVERSION,@@PROCID,@@MAX_CONNECTIONS,@@NESTLEVEL,@@CURSOR_ROWS
supported-1.2.0=@@DBTS,@@LOCK_TIMEOUT,@@SERVICENAME
default_classification-Ignored=@@TEXTSIZE
report_group-Transactions=@@TRANCOUNT
report_group-Cursors=@@FETCH_STATUS,@@CURSOR_ROWS
report_group-SET options=@@OPTIONS
report_group=@@variables

[@@ERROR value]
supported-1.0.0=0,102,132,133,134,135,136,141,142,153,155,180,217,219,220,232,266,289,293,306,346,352,477,487,506,512,515,517,545,547,550,556,574,628,1034,1049,1051,1205,1505,1715,1752,1765,1768,1776,1778,1801,1946,2627,2714,2732,2747,2787,3609,3616,3623,3701,3723,3726,3728,3729,3732,3902,3903,3914,3930,4514,4708,4712,4901,4920,6401,8003,8004,8007,8009,8011,8016,8018,8023,8028,8029,8031,8032,8037,8043,8047,8050,8057,8058,8106,8107,8115,8134,8143,8152,8159,8179,9441,9451,9809,10610,10727,10733,10793,11555,11700,11701,11702,11703,11705,11706,11708,11709,11717,16901,16902,16903,16915,16916,16948,16950,18456,35100
supported-1.2.0=201,206,2733,8144,8145,8146
report_group=@@ERROR codes

[Regular variable named @@v]
rule=local_id_expr,execute_parameter
# not currently supported: referencing local variables or parameters with leading '@@' 
report_group=Identifiers

[Datatypes]
rule=id
list=HIERARCHYID,GEOGRAPHY,GEOMETRY,TIMESTAMP,ROWVERSION,CURSOR,XML,XML(xmlschema),CHARACTER VARYING,NATIONAL CHARACTER,NATIONAL CHARACTER VARYING,NCHARACTER,NCHARACTER VARYING,XML COLUMN_SET FOR ALL_SPARSE_COLUMNS
# all other datatypes (not mentioned here) are supported
supported-1.0.0=XML
supported-1.2.0=TIMESTAMP,ROWVERSION
report_group-HIERARCHYID=HIERARCHYID
report_group-XML=XML,XML(xmlschema),XML COLUMN_SET FOR ALL_SPARSE_COLUMNS
report_group-Cursors=CURSOR
report_group-Geospatial=GEOGRAPHY,GEOMETRY

[TIMESTAMP column without column name]
rule=column_definition
supported-1.2.0=*
report_group=DDL

[NUMERIC/DECIMAL column with non-numeric default]
rule=column_definition
supported-1.1.0=*
rule=column_definition

[Maximum precision IDENTITY column]
rule=column_definition
supported-1.0.0=18
report_group=Datatypes

[SQL graph]
rule=column_constraint,graph_clause

[Table variables]
rule=declare_statement
supported-1.0.0=*
report_group=Table variables/Table types

[Table value constructor]
# not supported in FROM-clause
rule=table_value_constructor
report_group=DML

[XML features]
rule=xml_value_call,xml_query_call,xml_exist_call,xml_modify_call,xml_nodes_method,function_call,for_clause,create_xml_schema_collection,alter_xml_schema_collection,xml_type_definition,create_xml_index,create_selective_xml_index
list=EXIST,MODIFY,VALUE,QUERY,NODES,SELECT FOR XML AUTO,SELECT FOR XML AUTO ELEMENTS,SELECT FOR XML EXPLICIT,SELECT FOR XML PATH,SELECT FOR XML PATH ELEMENTS,SELECT FOR XML RAW,SELECT FOR XML RAW ELEMENTS,XML SCHEMA COLLECTION,XML TYPE DEFINITION,XML INDEX,SELECTIVE XML INDEX,WITH XMLNAMESPACES
report_group=XML
supported-1.0.0=SELECT FOR XML PATH,SELECT FOR XML RAW

[JSON features]
rule=for_clause
list=SELECT FOR JSON AUTO,SELECT FOR JSON PATH
report_group=JSON

[HIERARCHYID features]
rule=function_call,hierarchyid_methods,hierarchyid_coloncolon_methods
list=GETANCESTOR,GETDESCENDANT,GETLEVEL,ISDESCENDANTOF,READ,GETREPARENTEDVALUE,TOSTRING,GETROOT,PARSE
report_group=HIERARCHYID

[CURSOR variables]  
rule=set_statement
report_group=Cursors

[Aggregate functions]
rule=aggregate_windowed_function,ranking_windowed_function,analytic_windowed_function
list=SUM,AVG,MAX,MIN,COUNT,COUNT_BIG,APPROX_COUNT_DISTINCT,CHECKSUM_AGG,CUME_DIST,DENSE_RANK,DENSE_RANK,DISTINCT,FIRST_VALUE,GROUPING,GROUPING_ID,LAG,LAST_VALUE,LEAD,NTILE,PERCENTILE_CONT,PERCENTILE_DISC,PERCENT_RANK,RANK,ROWCOUNT_BIG,ROW_NUMBER,STDEV,STDEVP,STRING_AGG,VAR,VARP
supported-1.0.0=SUM,AVG,MAX,MIN,COUNT,COUNT_BIG,CUME_DIST,DENSE_RANK,DENSE_RANK,DISTINCT,FIRST_VALUE,GROUPING,LAG,LAST_VALUE,LEAD,NTILE,PERCENTILE_CONT,PERCENTILE_DISC,PERCENT_RANK,RANK,ROW_NUMBER,STRING_AGG

[Built-in functions]
rule=function_call
list=ABS,ACOS,APPLOCK_MODE,APPLOCK_TEST,APP_NAME,ASCII,ASIN,ASSEMBLYPROPERTY,ASYMKEYPROPERTY,ASYMKEY_ID,ATAN,ATN2,BINARY_CHECKSUM,CAST,CEILING,CERTENCODED,CERTPRIVATEKEY,CERTPROPERTY,CERT_ID,CHAR,CHARINDEX,CHECKSUM,CHOOSE,COALESCE,COLLATIONPROPERTY,COLUMNPROPERTY,COLUMNS_UPDATED,COL_LENGTH,COL_NAME,COMPRESS,CONCAT,CONCAT_WS,CONNECTIONPROPERTY,CONTAINS,CONTAINSTABLE,CONTEXT_INFO,CONVERT,COS,COT,CURRENT_REQUEST_ID,CURRENT_TIMESTAMP,CURRENT_TIMEZONE,CURRENT_TIMEZONE_ID,CURRENT_TRANSACTION_ID,CURRENT_USER,CURSOR_STATUS,DATABASEPROPERTY,DATABASEPROPERTYEX,DATABASE_PRINCIPAL_ID,DATALENGTH,DATEADD,DATEDIFF,DATEDIFF_BIG,DATEFROMPARTS,DATENAME,DATEPART,DATETIME2FROMPARTS,DATETIMEFROMPARTS,DATETIMEOFFSETFROMPARTS,DAY,DB_ID,DB_NAME,DECOMPRESS,DEGREES,DIFFERENCE,EOMONTH,ERROR_LINE,ERROR_MESSAGE,ERROR_NUMBER,ERROR_PROCEDURE,ERROR_SEVERITY,ERROR_STATE,EVENTDATA,EXP,FILEGROUPPROPERTY,FILEGROUP_ID,FILEGROUP_NAME,FILEPROPERTY,FILEPROPERTYEX,FILE_ID,FILE_IDEX,FILE_NAME,FLOOR,FN_GET_SQL,FORMAT,FORMATMESSAGE,GETANSINULL,GETDATE,GETUTCDATE,GET_FILESTREAM_TRANSACTION_CONTEXT,HASHBYTES,HAS_DBACCESS,HAS_PERMS_BY_NAME,HOST_ID,HOST_NAME,IDENTITY,IDENT_CURRENT,IDENT_INCR,IDENT_SEED,IIF,INDEXKEY_PROPERTY,INDEXPROPERTY,INDEX_COL,ISDATE,ISJSON,ISNULL,ISNUMERIC,IS_MEMBER,IS_OBJECTSIGNED,IS_ROLEMEMBER,IS_SRVROLEMEMBER,JSON,JSON_MODIFY,JSON_QUERY,JSON_VALUE,KEY_GUID,KEY_ID,KEY_NAME,LEFT,LEN,LOG,LOG10,LOGINPROPERTY,LOWER,LTRIM,MIN_ACTIVE_ROWVERSION,MONTH,NCHAR,NEWID,NEWSEQUENTIALID,NULLIF,OBJECTPROPERTY,OBJECTPROPERTYEX,OBJECT_DEFINITION,OBJECT_ID,OBJECT_NAME,OBJECT_SCHEMA_NAME,OPENDATASOURCE,OPENJSON,OPENQUERY,OPENROWSET,OPENXML,ORIGINAL_DB_NAME,ORIGINAL_LOGIN,PARSE,PARSENAME,PARTITION,PATINDEX,PERMISSIONS,PI,POWER,PUBLISHINGSERVERNAME,QUOTENAME,RADIANS,RAND,REPLACE,REPLICATE,REVERSE,RIGHT,ROUND,ROWCOUNT_BIG,RTRIM,SCHEMA_ID,SCHEMA_NAME,SCOPE_IDENTITY,SERVERPROPERTY,SESSIONPROPERTY,SESSION_CONTEXT,SESSION_USER,SIGN,SIGNBYASYMKEY,SIGNBYCERT,SIN,SMALLDATETIMEFROMPARTS,SOUNDEX,SPACE,SQL_VARIANT_PROPERTY,SQRT,SQUARE,STATS_DATE,STR,STRING_AGG,STRING_ESCAPE,STRING_SPLIT,STUFF,SUBSTRING,SUSER_ID,SUSER_NAME,SUSER_SID,SUSER_SNAME,SID_BINARY,SWITCHOFFSET,SYMKEYPROPERTY,SYSDATETIME,SYSDATETIMEOFFSET,SYSTEM_USER,SYSUTCDATETIME,TAN,TERTIARY_WEIGHTS,TEXTPTR,TEXTVALID,TIMEFROMPARTS,TODATETIMEOFFSET,TRANSLATE,TRIGGER_NESTLEVEL,TRIM,TRY_CAST,TRY_CONVERT,TRY_PARSE,TYPEPROPERTY,TYPE_ID,TYPE_NAME,UNICODE,UPDATE,UPPER,USER,USER_ID,USER_NAME,VERIFYSIGNEDBYASMKEY,VERIFYSIGNEDBYCERT,VERIGYSIGNEDBYCERT,XACT_STATE,YEAR,CHANGETABLE,CHANGE_TRACKING_MIN_VALID_VERSION,CHANGE_TRACKING_CURRENT_VERSION,CHANGE_TRACKING_IS_COLUMN_IN_MASK,CHANGE_TRACKING_CONTEXT,DEFAULT_DOMAIN,FILETABLEROOTPATH,GETFILENAMESPACEPATH,GETPATHLOCATOR,PATHNAME,CONTAINSTABLE,FREETEXT,FREETEXTTABLE,SEMANTICKEYPHRASETABLE,SEMANTICSIMILARITYDETAILSTABLE,SEMANTICSIMILARITYTABLE,FULLTEXTCATALOGPROPERTY,FULLTEXTSERVICEPROPERTY,ENCRYPTBYASYMKEY,ENCRYPTBYCERT,ENCRYPTBYKEY,ENCRYPTBYPASSPHRASE,PWDCOMPARE,PWDENCRYPT,DECRYPTBYASYMKEY,DECRYPTBYCERT,DECRYPTBYKEY,DECRYPTBYKEYAUTOASYMKEY,DECRYPTBYKEYAUTOCERT,DECRYPTBYPASSPHRASE,DECRYPTBYKEYAUTOCERT,PREDICT
supported-1.0.0=ABS,ACOS,ASCII,ASIN,ATAN,APPLOCK_MODE,APPLOCK_TEST,CAST,CEILING,CHAR,CHARINDEX,CHECKSUM,COALESCE,CONCAT,CONVERT,COS,COT,CURRENT_TIMESTAMP,CURRENT_USER,USER,DATALENGTH,DATEADD,DATEDIFF,DATENAME,DATEPART,DAY,DB_ID,DB_NAME,SUSER_ID,SUSER_NAME,USER_ID,USER_NAME,DEFAULT_DOMAIN,DEGREES,EXP,ERROR_LINE,ERROR_MESSAGE,ERROR_NUMBER,ERROR_PROCEDURE,ERROR_SEVERITY,ERROR_STATE,FLOOR,GETDATE,GETUTCDATE,IIF,ISDATE,ISNULL,ISNUMERIC,LEFT,LEN,LOG,LOG10,LOWER,LTRIM,MONTH,NCHAR,NEWID,NULLIF,OBJECT_ID,OBJECT_NAME,PATINDEX,PI,POWER,RADIANS,RAND,REPLACE,REPLICATE,REVERSE,RIGHT,ROUND,RTRIM,SCOPE_IDENTITY,IDENT_CURRENT,IDENT_INCR,IDENT_SEED,SCHEMA_ID,SCHEMA_NAME,SERVERPROPERTY,SIGN,SIN,SPACE,SQRT,STRING_AGG,STRING_SPLIT,STUFF,SUBSTRING,SYSDATETIME,SYSDATETIMEOFFSET,SYSUTCDATETIME,TAN,TRIM,TRY_CAST,TRY_PARSE,UPPER,YEAR,QUOTENAME,XACT_STATE,STRING_ESCAPE,DATABASEPROPERTYEX,CONNECTIONPROPERTY,SQL_VARIANT_PROPERTY,SESSIONPROPERTY,COLLATIONPROPERTY
supported-1.1.0=CONCAT_WS,DATEFROMPARTS,DATETIMEFROMPARTS,ORIGINAL_LOGIN,SESSION_USER,SQUARE,CHOOSE,TRIGGER_NESTLEVEL,CURSOR_STATUS
supported-1.2.0=COLUMNS_UPDATED,UPDATE,FULLTEXTSERVICEPROPERTY,ISJSON,JSON_QUERY,JSON_VALUE,HAS_DBACCESS,SUSER_SID,SUSER_SNAME,IS_SRVROLEMEMBER
default_classification-ReviewSemantics=NEWSEQUENTIALID
report_group-Filestream=FILETABLEROOTPATH,GETFILENAMESPACEPATH,GETPATHLOCATOR,PATHNAME
report_group-Fulltext Search=CONTAINS,CONTAINSTABLE,FREETEXT,FREETEXTTABLE,SEMANTICKEYPHRASETABLE,SEMANTICSIMILARITYDETAILSTABLE,SEMANTICSIMILARITYTABLE,FULLTEXTCATALOGPROPERTY,FULLTEXTSERVICEPROPERTY
report_group-Encryption=ENCRYPTBYASYMKEY,ENCRYPTBYCERT,ENCRYPTBYKEY,ENCRYPTBYPASSPHRASE,PWDCOMPARE,PWDENCRYPT,DECRYPTBYASYMKEY,DECRYPTBYCERT,DECRYPTBYKEY,DECRYPTBYKEYAUTOASYMKEY,DECRYPTBYKEYAUTOCERT,DECRYPTBYPASSPHRASE,DECRYPTBYKEYAUTOCERT
report_group-XML=OPENXML
report_group-Triggers=EVENTDATA,COLUMNS_UPDATED,UPDATE
report_group-Transactions=CURRENT_TRANSACTION_ID
report_group-JSON=OPENJSON,ISJSON,JSON,JSON_MODIFY,JSON_QUERY,JSON_VALUE

[HASHBYTES]
rule=function_call
supported-1.0.0=arg1=MD5,SHA1,SHA2_256,SHA2_512
report_group=Built-in functions

[CHECKSUM]
rule=function_call
#list=STAR,SINGLE ARGUMENT,MULTIPLE ARGUMENTS    #values for validating 
supported-1.0.0=arg1=SINGLE ARGUMENT
supported-1.2.0=arg1=STAR,MULTIPLE ARGUMENTS
report_group=Built-in functions

[expression AT TIME ZONE]
rule=expression

[Variable aggregates across rows]
rule=update_statement,select_statement
default_classification=ReviewSemantics

[Variable assignment dependency]
rule=update_statement,select_statement
default_classification=ReviewSemantics

[TRIGGER_NESTLEVEL with N arguments]
rule=function_call
supported-1.1.0=0
report_group=Built-in functions

[SCHEMA_NAME with N arguments]
rule=function_call
supported-1.0.0=1
supported-1.1.0=0
report_group=Built-in functions

[SCHEMA_ID with N arguments]
rule=function_call
supported-1.0.0=1
supported-1.2.0=0
report_group=Built-in functions

[Numeric representation of datetime]
rule=function_call
list=DATEADD,DATEDIFF,DATEPART,DATENAME,CAST,TRY_CAST,CONVERT,TRY_CONVERT,PARSE,TRY_PARSE

[Numeric assignment to datetime variable/parameter/column]
rule=set_statement,select_list_elem,declare_local,procedure_param,column_definition
report_group=Numeric representation of datetime

#--- tables/columns -----

[Column attribute]
rule=special_column_option
list=ROWGUIDCOL,SPARSE,FILESTREAM,MASKED
report_group=DDL

[Inline index]
rule=table_indices,table_type_indices,column_inline_index
report_group=DDL

[CLUSTERED index]
rule=create_index,table_constraint
default_classification=ReviewSemantics

[DESC constraint]
rule=table_constraint
report_group=DDL
default_classification=ReviewPerformance

[FK constraint referencing DB name]
rule=table_constraint,column_constraint
report_group=DDL

[ALTER TABLE]
rule=alter_table
list=SET FILESTREAM_ON,SET SYSTEM_VERSIONING,REBUILD,SET LOCK_ESCALATION,SET FILETABLE,ENABLE CHANGE_TRACKING,DISABLE CHANGE_TRACKING,ENABLE TRIGGER,DISABLE TRIGGER,ADD PERIOD FOR SYSTEM TIME,DROP PERIOD FOR SYSTEM_TIME,DROP MULTIPLE ITEMS,DROP MULTIPLE COLUMNS,DROP MULTIPLE CONSTRAINTS,DROP CONSTRAINT_BY_NAME_ONLY,DROP CONSTRAINT,DROP COLUMN,CHECK CONSTRAINT,NOCHECK CONSTRAINT,ADD MULTIPLE COLUMNS/CONSTRAINTS,ADD COLUMN/CONSTRAINT,ADD COLUMN,ALTER COLUMN
supported-1.0.0=DROP CONSTRAINT,DROP COLUMN,ADD COLUMN/CONSTRAINT,ADD COLUMN,ALTER COLUMN
report_group=DDL
report_group-Triggers=ENABLE TRIGGER,DISABLE TRIGGER

[ALTER INDEX]
rule=alter_index
list=REBUILD
report_group=DDL

[IGNORE_DUP_KEY index]
rule=index_option
default_classification=ReviewSemantics
report_group=DDL

[Index options]
rule=index_option
list=FILLFACTOR,ALLOW_PAGE_LOCKS,ALLOW_ROW_LOCKS,PAD_INDEX,STATISTICS_NORECOMPUTE,OPTIMIZE_FOR_SEQUENTIAL_KEY,SORT_IN_TEMPDB,DROP_EXISTING,ONLINE,COMPRESSION_DELAY,MAXDOP,DATA_COMPRESSION
default_classification=Ignored
report_group=DDL

[Index attribute]
rule=create_index
list=COLUMNSTORE
default_classification=ReviewPerformance
report_group=DDL

[Maximum columns per index]
rule=create_index
supported-1.0.0=32
report_group=DDL

[Nullable column]
rule=create_index,table_constraint
list=UNIQUE CONSTRAINT SINGLE,UNIQUE INDEX SINGLE,UNIQUE CONSTRAINT MULTIPLE,UNIQUE INDEX MULTIPLE
report_group=DDL
default_classification=ReviewSemantics

[Partitioning]
rule=create_table,alter_table,create_index,alter_index,truncate_table
list=CREATE TABLE,ALTER TABLE SWITCH,ALTER TABLE REBUILD,ALTER TABLE SPLIT,ALTER TABLE MERGE,ALTER INDEX REBUILD,CREATE INDEX,TRUNCATE TABLE,$PARTITION,CREATE PARTITION SCHEME,ALTER PARTITION SCHEME,CREATE PARTITION FUNCTION,ALTER PARTITION FUNCTION,DROP PARTITION SCHEME,DROP PARTITION SCHEME
report_group=DDL

[FOR REPLICATION]
rule=for_replication
# not all these combinations are possible, but keeping it flexible
list=FOREIGN KEY,CHECK,IDENTITY,PROCEDURE,TRIGGER
default_classification=Ignored
report_group=DDL

[NOT FOR REPLICATION]
rule=for_replication
# not all these combinations are possible, but keeping it flexible
list=FOREIGN KEY,CHECK,IDENTITY,PROCEDURE,TRIGGER
default_classification=Ignored
report_group=DDL

[Non-PERSISTED computed columns]
rule=column_definition
default_classification=ReviewPerformance
report_group=DDL
# Babelfish currently only supports the equivalent of persisted computed columns

[Features in computed columns]
rule=column_definition
list=SCALAR_UDF_CALL,XML_METHOD_CALL,HIERARCHYID_METHOD_CALL,RAND,GETDATE,GETUTCDATE  
report_group=DDL

[Global Temporary Tables]
rule=table_name
report_group=DDL

[DROP multiple objects]
rule=drop_table,drop_view,drop_procedure,drop_function,drop_database
list=TABLE,VIEW,PROCEDURE,FUNCTION,TRIGGER,DATABASE,INDEX
supported-1.0.0=TABLE,VIEW,PROCEDURE,FUNCTION
report_group=DDL

[DROP IF EXISTS]
rule=drop_table,drop_view,drop_procedure,drop_function,drop_database,drop_user,drop_schema
list=TABLE,VIEW,PROCEDURE,FUNCTION,DATABASE,USER,SCHEMA,INDEX
supported-1.0.0=TABLE,VIEW,PROCEDURE,FUNCTION,DATABASE,INDEX    
supported-1.2.0=SCHEMA,DATABASE,USER
report_group=DDL
         
[DROP INDEX]
rule=drop_index
list=INDEX ON TABLE,INDEX ON SCHEMA.TABLE,TABLE.INDEX,SCHEMA.TABLE.INDEX
supported-1.0.0=INDEX ON TABLE    
report_group=DDL  

#--- xxxPROPERTY() functions -----

[SERVERPROPERTY]
rule=function_call
supported-1.0.0=arg1=Collation,CollationID,Edition,IsSingleUser,ServerName,Babelfish
supported-1.2.0=arg1=Babelfish,Collation,CollationID,Edition,EditionID,EngineEdition,ServerName,LicenseType,ProductVersion,ProductMajorVersion,ProductMinorVersion,IsSingleUser,IsIntegratedSecurityOnly,IsLocalDB,IsAdvancedAnalyticsInstalled,IsBigDataCluster,IsPolyBaseInstalled,IsFullTextInstalled,IsXTPSupported

[CONNECTIONPROPERTY]
rule=function_call
supported-1.0.0=arg1=net_transport,protocol_type,auth_scheme,local_tcp_port
supported-1.2.0=arg1=physical_net_transport,client_net_address

[DATABASEPROPERTYEX]
rule=function_call
supported-1.0.0=arg2=Collation,Edition,IsAutoClose,IsAutoCreateStatistics,IsInStandBy,IsTornPageDetectionEnabled,Status,Updateability,Version

[SQL_VARIANT_PROPERTY]
rule=function_call
supported-1.0.0=arg2=*

[COLLATIONPROPERTY] 
rule=function_call
supported-1.0.0=*

[SESSIONPROPERTY]
rule=function_call
supported-1.0.0=*

[LOGINPROPERTY] 
rule=function_call
supported-1.0.0=arg2=NO_SUPPORTED_ARGUMENTS_RIGHT_NOW

[COLUMNPROPERTY] 
rule=function_call
supported-1.1.0=arg3=CharMaxLen,AllowsNull

[OBJECTPROPERTY] 
rule=function_call
supported-1.0.0=arg2=NO_SUPPORTED_ARGUMENTS_RIGHT_NOW

[OBJECTPROPERTYEX]
rule=function_call 
supported-1.0.0=arg2=NO_SUPPORTED_ARGUMENTS_RIGHT_NOW 

[TYPEPROPERTY]
rule=function_call
supported-1.0.0=arg2=NO_SUPPORTED_ARGUMENTS_RIGHT_NOW

[INDEXPROPERTY]
rule=function_call
supported-1.0.0=arg3=NO_SUPPORTED_ARGUMENTS_RIGHT_NOW

[INDEXKEY_PROPERTY]
rule=function_call
supported-1.0.0=arg4=NO_SUPPORTED_ARGUMENTS_RIGHT_NOW

#--- Procedures, Functions, Triggers, Views -----

[ALTER VIEW]
rule=create_or_alter_view
report_group=Views

[ALTER PROCEDURE]
rule=create_or_alter_procedure
report_group=Procedures

[ALTER FUNCTION]
rule=create_or_alter_function
report_group=Functions

[ALTER TRIGGER]
rule=create_or_alter_dml_trigger,create_or_alter_ddl_trigger
report_group=Triggers

[DDL TRIGGER]
rule=create_or_alter_ddl_trigger
list=LOGON,ADD_ROLE_MEMBER,ADD_SERVER_ROLE_MEMBER,ADD_SIGNATURE,ADD_SIGNATURE_SCHEMA_OBJECT,ALTER_APPLICATION_ROLE,ALTER_ASSEMBLY,ALTER_ASYMMETRIC_KEY,ALTER_AUTHORIZATION,ALTER_AUTHORIZATION_DATABASE,ALTER_AUTHORIZATION_SERVER,ALTER_AVAILABILITY_GROUP,ALTER_BROKER_PRIORITY,ALTER_CERTIFICATE,ALTER_CREDENTIAL,ALTER_CRYPTOGRAPHIC_PROVIDER,ALTER_DATABASE,ALTER_DATABASE_AUDIT_SPECIFICATION,ALTER_DATABASE_AUDIT_SPEFICIATION,ALTER_DATABASE_ENCRYPTION_KEY,ALTER_ENDPOINT,ALTER_EVENT_SESSION,ALTER_EXTENDED_PROPERTY,ALTER_FULLTEXT_CATALOG,ALTER_FULLTEXT_INDEX,ALTER_FULLTEXT_STOPLIST,ALTER_FUNCTION,ALTER_INDEX,ALTER_INSTANCE,ALTER_LINKED_SERVER,ALTER_LOGIN,ALTER_MASTER_KEY,ALTER_MESSAGE,ALTER_MESSAGE_TYPE,ALTER_PARTITION_FUNCTION,ALTER_PARTITION_SCHEME,ALTER_PLAN_GUIDE,ALTER_PROCEDURE,ALTER_QUEUE,ALTER_REMOTE_SERVER,ALTER_REMOTE_SERVICE_BINDING,ALTER_RESOURCE_GOVERNOR_CONFIG,ALTER_RESOURCE_POOL,ALTER_ROLE,ALTER_ROUTE,ALTER_SCHEMA,ALTER_SEARCH_PROPERTY_LIST,ALTER_SEQUENCE,ALTER_SERVER_AUDIT,ALTER_SERVER_AUDIT_SPECIFICATION,ALTER_SERVER_CONFIGURATION,ALTER_SERVER_ROLE,ALTER_SERVICE,ALTER_SERVICE_MASTER_KEY,ALTER_SYMMETRIC_KEY,ALTER_TABLE,ALTER_TRIGGER,ALTER_USER,ALTER_VIEW,ALTER_WORKLOAD_GROUP,ALTER_XML_SCHEMA_COLLECTION,BACKUP_SERVICE_MASTER_KEY,BIND_DEFAULT,BIND_RULE,CREATE_APPLICATION_ROLE,CREATE_ASSEMBLY,CREATE_ASYMMETRIC_KEY,CREATE_AVAILABILITY_GROUP,CREATE_BROKER_PRIORITY,CREATE_CERTIFICATE,CREATE_CONTRACT,CREATE_CREDENTIAL,CREATE_CRYPTOGRAPHIC_PROVIDER,CREATE_DATABASE,CREATE_DATABASE_AUDIT_SPECIFICATION,CREATE_DATABASE_AUDIT_SPEFICIATION,CREATE_DATABASE_ENCRYPTION_KEY,CREATE_DEFAULT,CREATE_ENDPOINT,CREATE_EVENT_NOTIFICATION,CREATE_EVENT_SESSION,CREATE_EXTENDED_PROCEDURE,CREATE_EXTENDED_PROPERTY,CREATE_FULLTEXT_CATALOG,CREATE_FULLTEXT_INDEX,CREATE_FULLTEXT_STOPLIST,CREATE_FUNCTION,CREATE_INDEX,CREATE_LINKED_SERVER,CREATE_LINKED_SERVER_LOGIN,CREATE_LOGIN,CREATE_MASTER_KEY,CREATE_MESSAGE,CREATE_MESSAGE_TYPE,CREATE_PARTITION_FUNCTION,CREATE_PARTITION_SCHEME,CREATE_PLAN_GUIDE,CREATE_PROCEDURE,CREATE_QUEUE,CREATE_REMOTE_SERVER,CREATE_REMOTE_SERVICE_BINDING,CREATE_RESOURCE_POOL,CREATE_ROLE,CREATE_ROUTE,CREATE_RULE,CREATE_SCHEMA,CREATE_SEARCH_PROPERTY_LIST,CREATE_SEQUENCE,CREATE_SEQUENCE_EVENTS,CREATE_SERVER_AUDIT,CREATE_SERVER_AUDIT_SPECIFICATION,CREATE_SERVER_ROLE,CREATE_SERVICE,CREATE_SPATIAL_INDEX,CREATE_STATISTICS,CREATE_SYMMETRIC_KEY,CREATE_SYNONYM,CREATE_TABLE,CREATE_TRIGGER,CREATE_TYPE,CREATE_USER,CREATE_VIEW,CREATE_WORKLOAD_GROUP,CREATE_XML_INDEX,CREATE_XML_SCHEMA_COLLECTION,DDL_APPLICATION_ROLE_EVENTS,DDL_ASSEMBLY_EVENTS,DDL_ASYMMETRIC_KEY_EVENTS,DDL_AUTHORIZATION_DATABASE_EVENTS,DDL_AUTHORIZATION_SERVER_EVENTS,DDL_AVAILABILITY_GROUP_EVENTS,DDL_BROKER_PRIORITY_EVENTS,DDL_CERTIFICATE_EVENTS,DDL_CONTRACT_EVENTS,DDL_CREDENTIAL_EVENTS,DDL_CRYPTOGRAPHIC_PROVIDER_EVENTS,DDL_CRYPTO_SIGNATURE_EVENTS,DDL_DATABASE_AUDIT_SPECIFICATION_EVENTS,DDL_DATABASE_ENCRYPTION_KEY_EVENTS,DDL_DATABASE_EVENTS,DDL_DATABASE_LEVEL_EVENTS,DDL_DATABASE_SECURITY_EVENTS,DDL_DEFAULT_EVENTS,DDL_ENDPOINT_EVENTS,DDL_EVENTS,DDL_EVENT_NOTIFICATION_EVENTS,DDL_EVENT_SESSION_EVENTS,DDL_EXTENDED_PROCEDURE_EVENTS,DDL_EXTENDED_PROPERTY_EVENTS,DDL_FULLTEXT_CATALOG_EVENTS,DDL_FULLTEXT_STOPLIST_EVENTS,DDL_FUNCTION_EVENTS,DDL_GDR_DATABASE_EVENTS,DDL_GDR_SERVER_EVENTS,DDL_INDEX_EVENTS,DDL_LINKED_SERVER_EVENTS,DDL_LINKED_SERVER_LOGIN_EVENTS,DDL_LOGIN_EVENTS,DDL_MASTER_KEY_EVENTS,DDL_MESSAGE_EVENTS,DDL_MESSAGE_TYPE_EVENTS,DDL_PARTITION_EVENTS,DDL_PARTITION_FUNCTION_EVENTS,DDL_PARTITION_SCHEME_EVENTS,DDL_PLAN_GUIDE_EVENTS,DDL_PROCEDURE_EVENTS,DDL_QUEUE_EVENTS,DDL_REMOTE_SERVER_EVENTS,DDL_REMOTE_SERVICE_BINDING_EVENTS,DDL_RESOURCE_GOVERNOR_EVENTS,DDL_RESOURCE_POOL,DDL_ROLE_EVENTS,DDL_ROUTE_EVENTS,DDL_RULE_EVENTS,DDL_SCHEMA_EVENTS,DDL_SEARCH_PROPERTY_LIST_EVENTS,DDL_SEQUENCE_EVENTS,DDL_SERVER_AUDIT_EVENTS,DDL_SERVER_AUDIT_SPECIFICATION_EVENTS,DDL_SERVER_LEVEL_EVENTS,DDL_SERVER_SECURITY_EVENTS,DDL_SERVICE_EVENTS,DDL_SERVICE_MASTER_KEY_EVENTS,DDL_SSB_EVENTS,DDL_STATISTICS_EVENTS,DDL_SYMMETRIC_KEY_EVENTS,DDL_SYNONYM_EVENTS,DDL_TABLE_EVENTS,DDL_TABLE_VIEW_EVENTS,DDL_TRIGGER_EVENTS,DDL_TYPE_EVENTS,DDL_USER_EVENTS,DDL_VIEW_EVENTS,DDL_WORKLOAD_GROUP,DDL_XML_SCHEMA_COLLECTION_EVENTS,DENY_DATABASE,DENY_DATABASE_AUDIT_SPEFICIATION,DENY_SERVER,DROP_APPLICATION_ROLE,DROP_ASSEMBLY,DROP_ASYMMETRIC_KEY,DROP_AVAILABILITY_GROUP,DROP_BROKER_PRIORITY,DROP_CERTIFICATE,DROP_CONTRACT,DROP_CREDENTIAL,DROP_CRYPTOGRAPHIC_PROVIDER,DROP_DATABASE,DROP_DATABASE_AUDIT_SPECIFICATION,DROP_DATABASE_ENCRYPTION_KEY,DROP_DEFAULT,DROP_ENDPOINT,DROP_EVENT_NOTIFICATION,DROP_EVENT_SESSION,DROP_EXTENDED_PROCEDURE,DROP_EXTENDED_PROPERTY,DROP_FULLTEXT_CATALOG,DROP_FULLTEXT_INDEX,DROP_FULLTEXT_STOPLIST,DROP_FUNCTION,DROP_INDEX,DROP_LINKED_SERVER,DROP_LINKED_SERVER_LOGIN,DROP_LOGIN,DROP_MASTER_KEY,DROP_MESSAGE,DROP_MESSAGE_TYPE,DROP_PARTITION_FUNCTION,DROP_PARTITION_SCHEME,DROP_PLAN_GUIDE,DROP_PROCEDURE,DROP_QUEUE,DROP_REMOTE_SERVER,DROP_REMOTE_SERVICE_BINDING,DROP_RESOURCE_POOL,DROP_ROLE,DROP_ROLE_MEMBER,DROP_ROUTE,DROP_RULE,DROP_SCHEMA,DROP_SEARCH_PROPERTY_LIST,DROP_SEQUENCE,DROP_SERVER_AUDIT,DROP_SERVER_AUDIT_SPECIFICATION,DROP_SERVER_ROLE,DROP_SERVER_ROLE_MEMBER,DROP_SERVICE,DROP_SIGNATURE,DROP_SIGNATURE_SCHEMA_OBJECT,DROP_STATISTICS,DROP_SYMMETRIC_KEY,DROP_SYNONYM,DROP_TABLE,DROP_TRIGGER,DROP_TYPE,DROP_USER,DROP_VIEW,DROP_WORKLOAD_GROUP,DROP_XML_SCHEMA_COLLECTION,GRANT_DATABASE,GRANT_SERVER,RENAME,RESTORE_SERVICE_MASTER_KEY,REVOKE_DATABASE,REVOKE_SERVER,UNBIND_DEFAULT,UNBIND_RULE,UPDATE_STATISTICS
report_group=Triggers

[Instead-Of Trigger]
rule=create_or_alter_dml_trigger
list=TABLE,VIEW
report_group=Triggers

[View options]
rule=create_or_alter_view
list=SCHEMABINDING,WITHOUT SCHEMABINDING,ENCRYPTION,VIEW_METADATA,CHECK OPTION
supported-1.0.0=SCHEMABINDING
default_classification-ReviewSemantics=WITHOUT SCHEMABINDING
report_group=Views

[Indexed view]
rule=create_index
report_group=Views

[Materialized view]
rule=create_materialized_view,alter_materialized_view
report_group=Views

[Parameter value DEFAULT]
rule=execute_parameter,function_call
list=procedure,function
report_group-Procedures=procedure
report_group-Functions=function

[Maximum parameters per procedure]
rule=create_or_alter_procedure
supported-1.0.0=100
report_group=Procedures

[Maximum parameters per function]
rule=create_or_alter_function
supported-1.0.0=100
report_group=Functions

[Procedure options]
rule=create_or_alter_procedure
list=EXTERNAL,ATOMIC NATIVELY COMPILED,ENCRYPTION,RECOMPILE,SCHEMABINDING,WITHOUT SCHEMABINDING,EXECUTE AS OWNER,EXECUTE AS CALLER,EXECUTE AS SELF,EXECUTE AS USER
supported-1.0.0=WITHOUT SCHEMABINDING
default_classification-ReviewSemantics=EXECUTE AS OWNER,EXECUTE AS CALLER
report_group=Procedures

[Execute procedure options]
rule=execute_body
list=RECOMPILE,RESULT SETS,RESULT SETS NONE,RESULT SETS UNDEFINED
supported-1.0.0=RESULT SETS,RESULT SETS NONE,RESULT SETS UNDEFINED
report_group=Procedures

[Execute string options]
rule=execute_body
list=AS LOGIN,AS USER,AT DATA_SOURCE,AT
report_group=Dynamic SQL

[Temporary procedures]
rule=create_or_alter_procedure
report_group=Procedures
default_classification=ReviewSemantics  

[Function options]
rule=create_or_alter_function
list=EXTERNAL,CLR,ATOMIC NATIVELY COMPILED,SCHEMABINDING,WITHOUT SCHEMABINDING,RETURNS NULL ON NULL INPUT,CALLED ON NULL INPUT,ENCRYPTION,INLINE,EXECUTE AS OWNER,EXECUTE AS CALLER,EXECUTE AS SELF,EXECUTE AS USER
supported-1.0.0=RETURNS NULL ON NULL INPUT,CALLED ON NULL INPUT,WITHOUT SCHEMABINDING
default_classification-ReviewSemantics=EXECUTE AS OWNER,EXECUTE AS CALLER
report_group=Functions

[EXECUTE SQL function]
rule=execute_body
report_group=Functions

[Trigger options]
rule=create_or_alter_dml_trigger,create_or_alter_ddl_trigger
list=EXTERNAL,NATIVE_COMPILATION,SCHEMABINDING,WITHOUT SCHEMABINDING,ENCRYPTION,APPEND,EXECUTE AS OWNER,EXECUTE AS CALLER,EXECUTE AS SELF,EXECUTE AS USER
supported-1.0.0=WITHOUT SCHEMABINDING
default_classification-ReviewSemantics=EXECUTE AS OWNER,EXECUTE AS CALLER
report_group=Triggers

[Transition table reference for multi-DML trigger]
rule=create_or_alter_dml_trigger
supported-1.1.0=*
report_group=Triggers

[Trigger created with schema name]
rule=create_or_alter_dml_trigger
supported-1.1.0=*
report_group=Triggers

[ENABLE TRIGGER]
rule=enable_trigger
report_group=Triggers

[DISABLE TRIGGER]
rule=disable_trigger
report_group=Triggers

[Procedure versioning (declaration)]
rule=create_or_alter_procedure
report_group=Procedures

[Procedure versioning (execution)]
rule=execute_body
report_group=Procedures

[Variable procedure name]
rule=execute_body
report_group=Procedures

[CREATE DATABASE options]
rule=create_database
list=COLLATE,CATALOG_COLLATION,ALLOW_SNAPSHOT_ISOLATION,ANSI_NULLS,ANSI_NULL_DEFAULT,ANSI_PADDING,ANSI_WARNINGS,ARITHABORT,AUTO_CLOSE,AUTO_SHRINK,AUTO_UPDATE_STATISTICS,AUTO_UPDATE_STATISTICS_ASYNC,DB_CHAINING,COMPATIBILITY_LEVEL,CONCAT_NULL_YIELDS_NULL,CONTAINMENT=PARTIAL,CONTAINMENT=NONE,CURSOR_CLOSE_ON_COMMIT,CURSOR_DEFAULT,DATE_CORRELATION_OPTIMIZATION,DELAYED_DURABILITY,DISABLE_BROKER,FILESTREAM,HONOR_BROKER_PRIORITY,MULTI_USER,NUMERIC_ROUNDABORT,PAGE_VERIFY,PARAMETERIZATION,QUERY_STORE,QUOTED_IDENTIFIER,READ_COMMITTED_SNAPSHOT,RECOVERY,RECURSIVE_TRIGGERS,TARGET_RECOVERY_TIME,TRUSTWORTHY
supported-1.0.0=COLLATE,CONTAINMENT=NONE
report_group=Databases

[ALTER DATABASE]
rule=alter_database,alter_database_scoped_configurations
report_group=Databases  

[ALTER DATABASE options]
rule=alter_database,alter_database_scoped_configuration
list=SCOPED CONFIGURATION,CURRENT,MODIFY NAME,COLLATE,CATALOG_COLLATION,ALLOW_SNAPSHOT_ISOLATION,ANSI_NULLS,ANSI_NULL_DEFAULT,ANSI_PADDING,ANSI_WARNINGS,ARITHABORT,AUTO_CLOSE,AUTO_SHRINK,AUTO_UPDATE_STATISTICS,AUTO_UPDATE_STATISTICS_ASYNC,DB_CHAINING,COMPATIBILITY_LEVEL,CONCAT_NULL_YIELDS_NULL,CURSOR_CLOSE_ON_COMMIT,CURSOR_DEFAULT,DATE_CORRELATION_OPTIMIZATION,DELAYED_DURABILITY,DISABLE_BROKER,FILESTREAM,HONOR_BROKER_PRIORITY,MULTI_USER,NUMERIC_ROUNDABORT,PAGE_VERIFY,PARAMETERIZATION,QUERY_STORE,QUOTED_IDENTIFIER,READ_COMMITTED_SNAPSHOT,RECOVERY,RECURSIVE_TRIGGERS,TARGET_RECOVERY_TIME,TRUSTWORTHY,ACCELERATED_DATABASE_RECOVERY
report_group=Databases    

[Delimited database name]  
# means: delimited DB name because it contains special characters otherwise not allowed in the DB name
rule=create_database,alter_database,use_statement   # ignoring drop_database 
supported-1.0.0=*
report_group=Databases

#--- Various -----

[Double-quoted string]
rule=char_string
list=STRING,EMBEDDED_DOUBLE_QUOTE,EMBEDDED_SINGLE_QUOTE
supported-1.0.0=STRING
report_group=default

[Unquoted string]
rule=execute_parameter,procedure_param
list=PARAMETER VALUE,PARAMETER DEFAULT
report_group=default

[Line continuation character]
rule=char_string,hex_string
list=CHAR,HEX
report_group=default

[SET QUOTED_IDENTIFIER in batch]
rule=set_special
report_group=SET options
default_classification=ReviewSemantics  

[MONEY literal]
rule=constant
supported-1.0.0=*  
report_group=default

[SELECT TOP without ORDER BY]  
rule=select_statement
default_classification=ReviewSemantics  

#[SELECT to client without ORDER BY]  
#rule=select_statement
#default_classification=ReviewSemantics  

[ODBC scalar function]
rule=odbc_scalar_function
report_group=Built-in functions

[ODBC literal]
rule=odbc_literal
report_group=Built-in functions

[Query hint]
rule=option
default_classification=Ignored   # all possible values are ignored
report_group=DML

[Join hint]
rule=join_hint
default_classification=Ignored  # all possible values are ignored
report_group=DML

[Table hint]
rule=table_hint
default_classification=Ignored  # all possible values are ignored except when indicated otherwise
default_classification-ReviewSemantics=HOLDLOCK,NOLOCK,PAGLOCK,ROWLOCK,TABLOCK,TABLOCKX,UPDLOCK,XLOCK,SERIALIZABLE,SNAPSHOT,READCOMMITTEDLOCK,READPAST,READUNCOMMITTED,REPEATABLEREAD
report_group=DML

[Cross-database reference]
rule=full_object_name
report_group=Identifiers

[Remote object reference]
rule=full_object_name
report_group=Identifiers

[Leading dots in identifier]
rule=full_object_name
supported-1.1.0=*
report_group=Identifiers

[Special column names]
rule=id
list=IDENTITYCOL,$IDENTITY,$ROWGUID
report_group=Identifiers

[Special characters in identifier]
rule=id
list=]],@      # double closing bracket is a special case
report_group=Identifiers

[Special characters in parameter]
rule=id
list=##      
report_group=Identifiers

[Maximum identifier length]
rule=id
supported-1.0.0=63
report_group=Identifiers

[WAITFOR]
rule=waitfor_statement
list=DELAY,TIME
report_group=default

[GOTO]
rule=goto_statement
supported-1.0.0=*
report_group=Control flow

[CHECKPOINT]
rule=checkpoint_statement
supported-1.0.0=*
report_group=Transactions
    
[NEXT VALUE FOR]
rule=function_call
report_group=Built-in functions
    
[Cursor options]
rule=cursor_statement
list=FORWARD_ONLY,SCROLL,STATIC,LOCAL,READ_ONLY,KEYSET,DYNAMIC,FAST_FORWARD,SCROLL_LOCKS,OPTIMISTIC,TYPE_WARNING,INSENSITIVE,FOR UPDATE
supported-1.0.0=FORWARD_ONLY,STATIC,LOCAL,READ_ONLY,INSENSITIVE
default_classification-Ignored=FAST_FORWARD
report_group=Cursors

[GLOBAL cursor]
rule=cursor_statement
list=OPEN,CLOSE,FETCH,DECLARE,DEALLOCATE CURSOR
report_group=Cursors

[FETCH cursor]
rule=fetch_cursor
list=NEXT,PRIOR,FIRST,LAST,ABSOLUTE,RELATIVE
supported-1.0.0=NEXT
report_group=Cursors

[DBA statements]
rule=backup_statement,restore_statement,kill_statement,reconfigure_statement,shutdown_statement
list=BACKUP,RESTORE,KILL,RECONFIGURE,SHUTDOWN
report_group=default

[ALTER SERVER CONFIGURATION]
rule=alter_server_configuration

[DBCC statements]
rule=dbcc_statement

[Traceflags]
rule=dbcc_statement

[Transactions]
rule=transaction_statement
list=BEGIN DISTRIBUTED TRANSACTION,TRANSACTION NAME IN VARIABLE,DELAYED_DURABILITY,MARK
supported-1.0.0=TRANSACTION NAME IN VARIABLE

[::function call (old syntax)]
rule=table_source_item
report_group=Functions

#--- System procedures/functions/catalogs -----

[Collations]
rule=collation
# not listing all possible 1000's of collations. If not mentioned as supported, it's not supported
# generally, not supported are %_ws,%_ks,%_vs,%_sc
supported-1.0.0=ARABIC_CS_AS,ARABIC_CI_AI,ARABIC_CI_AS,CHINESE_PRC_CS_AS,CHINESE_PRC_CI_AI,CHINESE_PRC_CI_AS,CYRILLIC_GENERAL_CS_AS,CYRILLIC_GENERAL_CI_AI,CYRILLIC_GENERAL_CI_AS,FINNISH_SWEDISH_CS_AS,FINNISH_SWEDISH_CI_AS,FINNISH_SWEDISH_CI_AI,FRENCH_CS_AS,FRENCH_CI_AS,FRENCH_CI_AI,KOREAN_WANSUNG_CS_AS,KOREAN_WANSUNG_CI_AS,KOREAN_WANSUNG_CI_AI,LATIN1_GENERAL_BIN2,LATIN1_GENERAL_90_BIN2,LATIN1_GENERAL_100_BIN2,LATIN1_GENERAL_140_BIN2,LATIN1_GENERAL_CI_AI,LATIN1_GENERAL_CI_AS,LATIN1_GENERAL_CS_AI,LATIN1_GENERAL_CS_AS,MODERN_SPANISH_CS_AS,MODERN_SPANISH_CI_AS,MODERN_SPANISH_CI_AI,POLISH_CS_AS,POLISH_CI_AS,POLISH_CI_AI,SQL_LATIN1_GENERAL_CP1250_CI_AS,SQL_LATIN1_GENERAL_CP1250_CS_AS,SQL_LATIN1_GENERAL_CP1251_CI_AS,SQL_LATIN1_GENERAL_CP1251_CS_AS,SQL_LATIN1_GENERAL_CP1_CI_AI,SQL_LATIN1_GENERAL_CP1_CI_AS,SQL_LATIN1_GENERAL_CP1_CI_AI,SQL_LATIN1_GENERAL_CP1_CS_AS,SQL_LATIN1_GENERAL_PREF_CP1_CI_AS,SQL_LATIN1_GENERAL_PREF_CP1_CS_AS,SQL_LATIN1_GENERAL_CP1253_CI_AS,SQL_LATIN1_GENERAL_CP1253_CS_AS,SQL_LATIN1_GENERAL_CP1254_CI_AS,SQL_LATIN1_GENERAL_CP1254_CS_AS,SQL_LATIN1_GENERAL_CP1255_CI_AS,SQL_LATIN1_GENERAL_CP1255_CS_AS,SQL_LATIN1_GENERAL_CP1256_CI_AS,SQL_LATIN1_GENERAL_CP1256_CS_AS,SQL_LATIN1_GENERAL_CP1257_CI_AS,SQL_LATIN1_GENERAL_CP1257_CS_AS,SQL_LATIN1_GENERAL_CP1258_CI_AS,SQL_LATIN1_GENERAL_CP1258_CS_AS,THAI_CS_AS,THAI_CI_AS,THAI_CI_AI,TRADITIONAL_SPANISH_CS_AS,TRADITIONAL_SPANISH_CI_AS,TRADITIONAL_SPANISH_CI_AI,TURKISH_CS_AS,TURKISH_CI_AS,TURKISH_CI_AI,UKRAINIAN_CS_AS,UKRAINIAN_CI_AS,UKRAINIAN_CI_AI,VIETNAMESE_CS_AS,VIETNAMESE_CI_AS,VIETNAMESE_CI_AI

[Case-sensitive collation]
rule=collation
list=SERVER,DATABASE,CATALOG_COLLATION,COLUMN,EXPRESSION
supported-1.0.0=COLUMN,EXPRESSION

[Catalogs]
rule=full_object_name
list=sysallocunits,sysaltfiles,sysasymkeys,sysaudacts,sysbinobjs,sysbinsubobjs,sysbrickfiles,syscacheobjects,syscerts,syscharsets,syschildinsts,sysclones,sysclsobjs,syscolpars,syscolumns,syscomments,syscompfragments,sysconfigures,sysconstraints,sysconvgroup,syscscolsegments,syscscontainers,syscsdictionaries,syscsrowgroups,syscurconfigs,syscursorcolumns,syscursorrefs,syscursors,syscursortables,sysdatabases,sysdbfiles,sysdbfrag,sysdbreg,sysdepends,sysdercv,sysdesend,sysdevices,sysendpts,sysextendedrecoveryforks,sysextfileformats,sysextsources,sysexttables,sysfgfrag,sysfilegroups,sysfiles,sysfiles1,sysfoqueues,sysforeignkeys,sysfos,sysftinds,sysftproperties,sysftsemanticsdb,sysftstops,sysfulltextcatalogs,sysguidrefs,sysidxstats,sysindexes,sysindexkeys,sysiscols,syslanguages,syslnklgns,syslockinfo,syslogins,syslogshippers,sysmatrixageforget,sysmatrixages,sysmatrixbricks,sysmatrixconfig,sysmatrixmanagers,sysmembers,sysmessages,sysmultiobjrefs,sysmultiobjvalues,sysnsobjs,sysobjects,sysobjkeycrypts,sysobjvalues,sysoledbusers,sysopentapes,sysowners,sysperfinfo,syspermissions,sysphfg,syspriorities,sysprivs,sysprocesses,sysprotects,syspru,sysprufiles,sysqnames,sysreferences,sysremotelogins,sysremsvcbinds,sysrmtlgns,sysrowsetrefs,sysrowsets,sysrscols,sysrts,sysscalartypes,sysschobjs,sysseobjvalues,sysservers,syssingleobjrefs,syssoftobjrefs,syssqlguides,system_columns,system_components_surface_area_configuration,system_internals_allocation_units,system_internals_partition_columns,system_internals_partitions,system_objects,system_parameters,system_sql_modules,system_views,systypedsubobjs,systypes,sysusermsgs,sysusers,syswebmethods,sysxlgns,sysxmitbody,sysxmitqueue,sysxmlcomponent,sysxmlfacet,sysxmlplacement,sysxprops,sysxsrvs,all_columns,all_objects,all_parameters,all_sql_modules,all_views,allocation_units,assemblies,assembly_files,assembly_modules,assembly_references,assembly_types,asymmetric_keys,availability_databases_cluster,availability_group_listener_ip_addresses,availability_group_listeners,availability_groups,availability_groups_cluster,availability_read_only_routing_lists,availability_replicas,backup_devices,certificates,change_tracking_databases,change_tracking_tables,check_constraints,column_encryption_key_values,column_encryption_keys,column_master_keys,column_store_dictionaries,column_store_row_groups,column_store_segments,column_type_usages,column_xml_schema_collection_usages,columns,computed_columns,configurations,conversation_endpoints,conversation_groups,conversation_priorities,credentials,crypt_properties,cryptographic_providers,data_spaces,database_audit_specification_details,database_audit_specifications,database_automatic_tuning_mode,database_automatic_tuning_options,database_credentials,database_files,database_filestream_options,database_mirroring,database_mirroring_endpoints,database_mirroring_witnesses,database_permissions,database_principals,database_query_store_options,database_recovery_status,database_role_members,database_scoped_configurations,database_scoped_credentials,databases,default_constraints,destination_data_spaces,dm_audit_actions,dm_audit_class_type_map,dm_broker_activated_tasks,dm_broker_connections,dm_broker_forwarded_messages,dm_broker_queue_monitors,dm_cache_hit_stats,dm_cache_size,dm_cache_stats,dm_cdc_errors,dm_cdc_log_scan_sessions,dm_clr_appdomains,dm_clr_loaded_assemblies,dm_clr_properties,dm_clr_tasks,dm_cluster_endpoints,dm_column_encryption_enclave,dm_column_encryption_enclave_operation_stats,dm_column_store_object_pool,dm_cryptographic_provider_properties,dm_database_encryption_keys,dm_db_column_store_row_group_operational_stats,dm_db_column_store_row_group_physical_stats,dm_db_data_pool_nodes,dm_db_data_pools,dm_db_external_language_stats,dm_db_external_script_execution_stats,dm_db_file_space_usage,dm_db_fts_index_physical_stats,dm_db_index_usage_stats,dm_db_log_space_usage,dm_db_mirroring_auto_page_repair,dm_db_mirroring_connections,dm_db_mirroring_past_actions,dm_db_missing_index_details,dm_db_missing_index_group_stats,dm_db_missing_index_group_stats_query,dm_db_missing_index_groups,dm_db_partition_stats,dm_db_persisted_sku_features,dm_db_rda_migration_status,dm_db_rda_schema_update_status,dm_db_script_level,dm_db_session_space_usage,dm_db_storage_pool_nodes,dm_db_storage_pools,dm_db_task_space_usage,dm_db_tuning_recommendations,dm_db_uncontained_entities,dm_db_xtp_checkpoint_files,dm_db_xtp_checkpoint_internals,dm_db_xtp_checkpoint_stats,dm_db_xtp_gc_cycle_stats,dm_db_xtp_hash_index_stats,dm_db_xtp_index_stats,dm_db_xtp_memory_consumers,dm_db_xtp_nonclustered_index_stats,dm_db_xtp_object_stats,dm_db_xtp_table_memory_stats,dm_db_xtp_transactions,dm_distributed_exchange_stats,dm_exec_background_job_queue,dm_exec_background_job_queue_stats,dm_exec_cached_plans,dm_exec_compute_node_errors,dm_exec_compute_node_status,dm_exec_compute_nodes,dm_exec_compute_pools,dm_exec_connections,dm_exec_distributed_request_steps,dm_exec_distributed_requests,dm_exec_distributed_sql_requests,dm_exec_dms_services,dm_exec_dms_workers,dm_exec_external_operations,dm_exec_external_work,dm_exec_function_stats,dm_exec_procedure_stats,dm_exec_query_memory_grants,dm_exec_query_optimizer_info,dm_exec_query_optimizer_memory_gateways,dm_exec_query_parallel_workers,dm_exec_query_profiles,dm_exec_query_resource_semaphores,dm_exec_query_stats,dm_exec_query_transformation_stats,dm_exec_requests,dm_exec_session_wait_stats,dm_exec_sessions,dm_exec_trigger_stats,dm_exec_valid_use_hints,dm_external_authentication,dm_external_script_execution_stats,dm_external_script_requests,dm_external_script_resource_usage_stats,dm_filestream_file_io_handles,dm_filestream_file_io_requests,dm_filestream_non_transacted_handles,dm_fts_active_catalogs,dm_fts_fdhosts,dm_fts_index_population,dm_fts_memory_buffers,dm_fts_memory_pools,dm_fts_outstanding_batches,dm_fts_population_ranges,dm_fts_semantic_similarity_population,dm_hadr_ag_threads,dm_hadr_auto_page_repair,dm_hadr_automatic_seeding,dm_hadr_availability_group_states,dm_hadr_availability_replica_cluster_nodes,dm_hadr_availability_replica_cluster_states,dm_hadr_availability_replica_states,dm_hadr_cluster,dm_hadr_cluster_members,dm_hadr_cluster_networks,dm_hadr_database_replica_cluster_states,dm_hadr_database_replica_states,dm_hadr_db_threads,dm_hadr_instance_node_map,dm_hadr_name_id_map,dm_hadr_physical_seeding_stats,dm_hpc_device_stats,dm_hpc_thread_proxy_stats,dm_io_backup_tapes,dm_io_cluster_shared_drives,dm_io_cluster_valid_path_names,dm_io_pending_io_requests,dm_logpool_hashentries,dm_logpool_stats,dm_os_buffer_descriptors,dm_os_buffer_pool_extension_configuration,dm_os_child_instances,dm_os_cluster_nodes,dm_os_cluster_properties,dm_os_dispatcher_pools,dm_os_dispatchers,dm_os_enumerate_fixed_drives,dm_os_host_info,dm_os_hosts,dm_os_job_object,dm_os_latch_stats,dm_os_loaded_modules,dm_os_memory_allocations,dm_os_memory_broker_clerks,dm_os_memory_brokers,dm_os_memory_cache_clock_hands,dm_os_memory_cache_counters,dm_os_memory_cache_entries,dm_os_memory_cache_hash_tables,dm_os_memory_clerks,dm_os_memory_node_access_stats,dm_os_memory_nodes,dm_os_memory_objects,dm_os_memory_pools,dm_os_nodes,dm_os_performance_counters,dm_os_process_memory,dm_os_ring_buffers,dm_os_schedulers,dm_os_server_diagnostics_log_configurations,dm_os_spinlock_stats,dm_os_stacks,dm_os_sublatches,dm_os_sys_info,dm_os_sys_memory,dm_os_tasks,dm_os_threads,dm_os_virtual_address_dump,dm_os_wait_stats,dm_os_waiting_tasks,dm_os_windows_info,dm_os_worker_local_storage,dm_os_workers,dm_pal_cpu_stats,dm_pal_disk_stats,dm_pal_net_stats,dm_pal_processes,dm_pal_spinlock_stats,dm_pal_vm_stats,dm_pal_wait_stats,dm_qn_subscriptions,dm_repl_articles,dm_repl_schemas,dm_repl_tranhash,dm_repl_traninfo,dm_resource_governor_configuration,dm_resource_governor_external_resource_pool_affinity,dm_resource_governor_external_resource_pools,dm_resource_governor_resource_pool_affinity,dm_resource_governor_resource_pool_volumes,dm_resource_governor_resource_pools,dm_resource_governor_workload_groups,dm_server_audit_status,dm_server_memory_dumps,dm_server_registry,dm_server_services,dm_tcp_listener_states,dm_tran_aborted_transactions,dm_tran_active_snapshot_database_transactions,dm_tran_active_transactions,dm_tran_commit_table,dm_tran_current_snapshot,dm_tran_current_transaction,dm_tran_database_transactions,dm_tran_global_recovery_transactions,dm_tran_global_transactions,dm_tran_global_transactions_enlistments,dm_tran_global_transactions_log,dm_tran_locks,dm_tran_persistent_version_store,dm_tran_persistent_version_store_stats,dm_tran_session_transactions,dm_tran_top_version_generators,dm_tran_transactions_snapshot,dm_tran_version_store,dm_tran_version_store_space_usage,dm_xe_map_values,dm_xe_object_columns,dm_xe_objects,dm_xe_packages,dm_xe_session_event_actions,dm_xe_session_events,dm_xe_session_object_columns,dm_xe_session_targets,dm_xe_sessions,dm_xtp_gc_queue_stats,dm_xtp_gc_stats,dm_xtp_system_memory_consumers,dm_xtp_threads,dm_xtp_transaction_recent_rows,dm_xtp_transaction_stats,edge_constraint_clauses,edge_constraints,endpoint_webmethods,endpoints,event_notification_event_types,event_notifications,events,extended_procedures,extended_properties,external_data_sources,external_file_formats,external_language_files,external_languages,external_libraries,external_libraries_installed,external_library_files,external_library_setup_errors,external_table_columns,external_tables,filegroups,filetable_system_defined_objects,filetables,foreign_key_columns,foreign_keys,fulltext_catalogs,fulltext_document_types,fulltext_index_catalog_usages,fulltext_index_columns,fulltext_index_fragments,fulltext_indexes,fulltext_languages,fulltext_semantic_language_statistics_database,fulltext_semantic_languages,fulltext_stoplists,fulltext_stopwords,fulltext_system_stopwords,function_order_columns,hash_indexes,http_endpoints,identity_columns,index_columns,index_resumable_operations,indexes,internal_partitions,internal_tables,key_constraints,key_encryptions,linked_logins,login_token,masked_columns,master_files,master_key_passwords,memory_optimized_tables_internal_attributes,message_type_xml_schema_collection_usages,messages,module_assembly_usages,numbered_procedure_parameters,numbered_procedures,objects,openkeys,parameter_type_usages,parameter_xml_schema_collection_usages,parameters,partition_functions,partition_parameters,partition_range_values,partition_schemes,partitions,periods,plan_guides,procedures,query_context_settings,query_store_plan,query_store_query,query_store_query_text,query_store_runtime_stats,query_store_runtime_stats_interval,query_store_wait_stats,registered_search_properties,registered_search_property_lists,remote_data_archive_databases,remote_data_archive_tables,remote_logins,remote_service_bindings,resource_governor_configuration,resource_governor_external_resource_pool_affinity,resource_governor_external_resource_pools,resource_governor_resource_pool_affinity,resource_governor_resource_pools,resource_governor_workload_groups,routes,schemas,securable_classes,security_policies,security_predicates,selective_xml_index_namespaces,selective_xml_index_paths,sensitivity_classifications,sequences,server_assembly_modules,server_audit_specification_details,server_audit_specifications,server_audits,server_event_notifications,server_event_session_actions,server_event_session_events,server_event_session_fields,server_event_session_targets,server_event_sessions,server_events,server_file_audits,server_memory_optimized_hybrid_buffer_pool_configuration,server_permissions,server_principal_credentials,server_principals,server_role_members,server_sql_modules,server_trigger_events,server_triggers,servers,service_broker_endpoints,service_contract_message_usages,service_contract_usages,service_contracts,service_message_types,service_queue_usages,service_queues,services,soap_endpoints,spatial_index_tessellations,spatial_indexes,spatial_reference_systems,sql_dependencies,sql_expression_dependencies,sql_logins,sql_modules,stats,stats_columns,symmetric_keys,synonyms,table_types,tables,tcp_endpoints,time_zone_info,trace_categories,trace_columns,trace_event_bindings,trace_events,trace_subclass_values,traces,transmission_queue,trigger_event_types,trigger_events,triggers,trusted_assemblies,type_assembly_usages,types,user_token,via_endpoints,views,xml_indexes,xml_schema_attributes,xml_schema_collections,xml_schema_component_placements,xml_schema_components,xml_schema_elements,xml_schema_facets,xml_schema_model_groups,xml_schema_namespaces,xml_schema_types,xml_schema_wildcard_namespaces,xml_schema_wildcards
supported-1.0.0=databases,sysdatabases,server_principals,objects,sysobjects,all_objects,schemas,tables,indexes,views,all_views,procedures,extended_properties,columns,all_columns,syscharsets,assemblies,assembly_types,sysforeignkeys,foreign_key_columns,foreign_keys,key_constraints
supported-1.1.0=sysindexes,syscolumns,system_objects,identity_columns,types,check_constraints,computed_columns,default_constraints,index_columns,sql_modules
supported-1.2.0=dm_os_host_info,dm_exec_sessions,dm_exec_connections,endpoints,table_types,database_principals,sysconfigures,syscurconfigs,configurations,sysprocesses

[INFORMATION_SCHEMA]
rule=full_object_name
list=CHECK_CONSTRAINTS,COLUMNS,COLUMN_DOMAIN_USAGE,COLUMN_PRIVILEGES,CONSTRAINT_COLUMN_USAGE,CONSTRAINT_TABLE_USAGE,DOMAINS,DOMAIN_CONSTRAINTS,KEY_COLUMN_USAGE,PARAMETERS,REFERENTIAL_CONSTRAINTS,ROUTINES,ROUTINE_COLUMNS,SCHEMATA,TABLES,TABLE_CONSTRAINTS,TABLE_PRIVILEGES,VIEWS,VIEW_COLUMN_USAGE,VIEW_TABLE_USAGE
supported-1.2.0=TABLES,COLUMNS,DOMAINS,TABLE_CONSTRAINTS
report_group=Catalogs

[System Stored Procedures]
rule=execute_body
# Using '%' wildcard in the 'list=' entry since enumerating all 1300+ procs is a little much; accepting potential false positives as a result
# NB: wildcards cannot be used in the other keys, like 'supported-1.0.0='
list=sp_addfunctionalunittocomponent,sp_ih%,sp_ms%,sp_oa%,sp_orbitmap,sp_postagentinfo,sp_setautosapasswordanddisable,sp_setobdcertificate,sp_add%,sp_add_trusted_assembly,sp_adjustpublisheridentityrange,sp_alter_nt_job_mem_configs,sp_altermessage,sp_approlepassword,sp_article%,sp_assembl%,sp_attach%,sp_audit_write,sp_autoindex%,sp_autostats,sp_availability_group_command_internal,sp_bcp_dbcmptlevel,sp_begin_parallel_nested_tran,sp_bindefault,sp_bindrule,sp_bindsession,sp_browsemergesnapshotfolder,sp_browsereplcmds,sp_browsesnapshotfolder,sp_build_histogram,sp_can_tlog_be_applied,sp_catalogs%,sp_cdc_%,sp_certify_removable,sp_change%,sp_change_tracking_waitforchanges,sp_check%,sp_checkinvalidivarticle,sp_clean%,sp_cloud_update_blob_tier,sp_column%,sp_commit_parallel_nested_tran,sp_configure%,sp_constr_col%,sp_control_dbmasterkey_password,sp_control_plan_guide,sp_copymergesnapshot,sp_copysnapshot,sp_copysubscription,sp_create_file_statistics,sp_create_plan_guide%,sp_create_removable,sp_createmergepalrole,sp_createorphan,sp_createstats,sp_createtranpalrole,sp_cursor%,sp_cycle_errorlog,sp_databases,sp_datatype_info%,sp_db_ebcdic277_2,sp_db_increased_partitions,sp_db_selective_xml_index,sp_db_vardecimal_storage_format,sp_dbcmptlevel,sp_dbfixedrolepermission,sp_dbmmonitor%,sp_dbremove,sp_ddopen,sp_defaultdb,sp_defaultlanguage,sp_delete%,sp_delete_backup_file_snapshot,sp_delete_http_namespace_reservation,sp_denylogin,sp_depends,sp_describe_%,sp_detach_db,sp_diagnostic_showplan_log_dbid,sp_disableagentoffload,sp_distcounters,sp_drop%,sp_dsninfo,sp_enable_heterogeneous_subscription,sp_enable_sql_debug,sp_enableagentoffload,sp_enclave_send_keys,sp_enum%,sp_estimate_data_compression_savings,sp_estimated_rowsize_reduction_for_vardecimal,sp_execute,sp_execute_external_script,sp_execute_remote,sp_executesql,sp_expired_subscription_cleanup,sp_fido_%,sp_filestream%,sp_firstonly_bitmap,sp_fkeys,sp_flush%,sp_flush_log,sp_force_slog_truncation,sp_foreign%,sp_fulltext_%,sp_generate_agent_parameter,sp_generatefilters,sp_getprocessorusage,sp_getvolumefreespace,sp_get_oracle_publisher_metadata,sp_get_database_scoped_credential,sp_get_distributor,sp_get_file_statistics_hash,sp_get_job_status_mergesubscription_agent,sp_get_mergepublishedarticleproperties,sp_get_query_template,sp_get_redirected_publisher,sp_getagentparameterlist,sp_getapplock,sp_getbindtoken,sp_getdefaultdatatypemapping,sp_getmergedeletetype,sp_getpublisherlink,sp_getqueuedarticlesynctraninfo,sp_getqueuedrows,sp_getschemalock,sp_getsqlqueueversion,sp_getsubscription_status_hsnapshot,sp_getsubscriptiondtspackagename,sp_gettopologyinfo,sp_grant_publication_access,sp_grantdbaccess,sp_grantlogin,sp_help%,sp_http_%,sp_identitycolumnforreplication,sp_index%,sp_internal_alter_nt_job_limits,sp_invalidate_textptr,sp_is_makegeneration_needed,sp_ivindexhasnullcols,sp_kill_filestream_non_transacted_handles,sp_kill_oldest_transaction_on_secondary,sp_lightweightmergemetadataretentioncleanup,sp_link_publication,sp_linkedservers%,sp_lock,sp_logshippinginstallmetadata,sp_lookupcustomresolver,sp_mapdown_bitmap,sp_markpendingschemachange,sp_marksubscriptionvalidation,sp_memory_optimized_cs_migration,sp_merge%,sp_migrate_user_to_contained,sp_monitor,sp_new_parallel_nested_tran_id,sp_objectfilegroup,sp_oledb%,sp_password,sp_peerconflictdetection_tableaug,sp_pkeys,sp_polybase_%,sp_posttracertoken,sp_prepare,sp_prepexec,sp_prepexecrpc,sp_primary%,sp_procedure%,sp_processlogshipping%,sp_procoption,sp_prop_oledb_provider,sp_provider_types%,sp_publication%,sp_publish%,sp_query_store_%,sp_rbpex_exec_cmd,sp_rda_%,sp_readerrorlog,sp_recompile,sp_redirect_publisher,sp_refresh%,sp_register%,sp_reinit%,sp_releaseapplock,sp_releaseschemalock,sp_remote_data_archive_event,sp_remoteoption,sp_remove%,sp_rename,sp_renamedb,sp_repl%,sp_requestpeer%,sp_reserve_http_namespace,sp_reset_connection,sp_reset_session_context,sp_resetsnapshotdeliveryprogress,sp_resetstatus,sp_resign_database,sp_resolve_logins,sp_restoredbreplication,sp_restoremergeidentityrange,sp_resync%,sp_resyncmergesubscription,sp_revoke%,sp_rollback_parallel_nested_tran,sp_schemafilter,sp_schemata_rowset,sp_script%,sp_sequence_get_range,sp_server_diagnostics,sp_server_info,sp_serveroption,sp_setoraclepackageversion,sp_set_distributed_query_context,sp_set_session_context,sp_set_session_resource_group,sp_setapprole,sp_setdefaultdatatypemapping,sp_setnetname,sp_setreplfailovermode,sp_setsubscriptionxactseqno,sp_settriggerorder,sp_setuserbylogin,sp_show_file_statistics,sp_showcolv,sp_showinitialmemo_xml,sp_showlineage,sp_showmemo_xml,sp_showpendingchanges,sp_showrowreplicainfo,sp_sm_detach,sp_spaceused%,sp_sparse_columns%,sp_special_columns%,sp_sproc_columns%,sp_sqlagent%,sp_sqlexec,sp_srvrolepermission,sp_start%,sp_statistics%,sp_stop%,sp_stored_procedures,sp_subscribe,sp_subscription%,sp_syspolicy%,sp_table%,sp_testlinkedserver,sp_trace_%,sp_try_set_session_context,sp_unbindefault,sp_unbindrule,sp_unprepare,sp_unregister%,sp_unsetapprole,sp_unsubscribe,sp_update_agent_profile,sp_update_user_instance,sp_updateextendedproperty,sp_updatestats,sp_upgrade_log_shipping,sp_user_counter%,sp_usertypes%,sp_validate%,sp_verifypublisher,sp_views%,sp_vupgrade%,sp_who,sp_who2,sp_xa_%,sp_xml_preparedocument,sp_xml_removedocument,sp_xml_schema_rowset%,sp_xp_cmdshell_proxy_account,sp_xtp_%,xp_%
supported-1.0.0=sp_helpdb,sp_getapplock,sp_releaseapplock,sp_columns,sp_columns_100,sp_columns_managed,sp_cursor_list,sp_datatype_info,sp_datatype_info_100,sp_describe_cursor,sp_describe_first_result_set,sp_describe_undeclared_parameters,sp_oledb_ro_usrname,sp_prepare,sp_tablecollations_100,sp_tables,sp_unprepare
supported-1.1.0=sp_statistics,sp_statistics_100,sp_updatestats,sp_pkeys,sp_databases,sp_cursor,sp_cursoropen,sp_cursorprepare,sp_cursorexecute,sp_cursorprepexec,sp_cursorunprepare,sp_cursorfetch,sp_cursoroption,sp_cursorclose
supported-1.2.0=sp_table_privileges,sp_column_privileges,sp_special_columns,sp_fkeys,sp_pkeys,sp_stored_procedures,xp_qv,sp_describe_undeclared_parameters,sp_helpuser
report_group-XML=SP_XML_PREPAREDOCUMENT,SP_XML_REMOVEDOCUMENT,SP_XML_SCHEMA_ROWSET,SP_XML_SCHEMA_ROWSET2

[System Functions]
rule=function_call
list=fn_enumcurrentprincipals,fn_getcurrentprincipal,fn_getrowsetidfromrowdump,fn_isbitsetinbitmask,fn_msdayasnumber,fn_msgeneration_downloadonly,fn_msget_dynamic_filter_login,fn_msorbitmaps,fn_msrepl_getsrvidfromdistdb,fn_msrepl_map_resolver_clsid,fn_mstestbit,fn_msvector_downloadonly,fn_msxe_read_event_stream,fn_mapschematype,fn_pagerescracker,fn_physloccracker,fn_physlocformatter,fn_rowdumpcracker,fn_builtin_permissions,fn_ccolventries_80,fn_cdc_check_parameters,fn_cdc_decrement_lsn,fn_cdc_get_column_ordinal,fn_cdc_get_max_lsn,fn_cdc_get_min_lsn,fn_cdc_has_column_changed,fn_cdc_hexstrtobin,fn_cdc_increment_lsn,fn_cdc_is_bit_set,fn_cdc_map_lsn_to_time,fn_cdc_map_time_to_lsn,fn_check_object_signatures,fn_column_store_row_groups,fn_db_backup_file_snapshots,fn_dblog,fn_dblog_xtp,fn_dbslog,fn_dump_dblog,fn_dump_dblog_xtp,fn_fiscoltracked,fn_full_dblog,fn_get_audit_file,fn_get_sql,fn_getproviderstring,fn_hadr_backup_is_preferred_replica,fn_hadr_distributed_ag_database_replica,fn_hadr_distributed_ag_replica,fn_hadr_is_primary_replica,fn_hadr_is_same_replica,fn_helpcollations,fn_helpdatatypemap,fn_isrolemember,fn_listextendedproperty,fn_my_permissions,fn_numberof1inbinaryafterloc,fn_numberof1invarbinary,fn_repl_hash_binary,fn_repladjustcolumnmap,fn_repldecryptver4,fn_replformatdatetime,fn_replgetcolidfrombitmap,fn_replgetparsedddlcmd,fn_replp2pversiontotranid,fn_replreplacesinglequote,fn_replreplacesinglequoteplusprotectstring,fn_repluniquename,fn_replvarbintoint,fn_servershareddrives,fn_sqlagent_job_history,fn_sqlagent_jobs,fn_sqlagent_jobsteps,fn_sqlagent_jobsteps_logs,fn_sqlagent_subsystems,fn_sqlvarbasetostr,fn_stmt_sql_handle_from_sql_stmt,fn_trace_geteventinfo,fn_trace_getfilterinfo,fn_trace_getinfo,fn_trace_gettable,fn_translate_permissions,fn_validate_plan_guide,fn_varbintohexstr,fn_varbintohexsubstring,fn_virtualfilestats,fn_virtualservernodes,fn_xe_file_target_read_file,fn_yukonsecuritymodelrequired,dm_cryptographic_provider_algorithms,dm_cryptographic_provider_keys,dm_cryptographic_provider_sessions,dm_db_database_page_allocations,dm_db_incremental_stats_properties,dm_db_index_operational_stats,dm_db_index_physical_stats,dm_db_log_info,dm_db_log_stats,dm_db_missing_index_columns,dm_db_objects_disabled_on_compatibility_level_change,dm_db_page_info,dm_db_stats_histogram,dm_db_stats_properties,dm_db_stats_properties_internal,dm_enumerate_blobdirectory,dm_exec_cached_plan_dependent_objects,dm_exec_cursors,dm_exec_describe_first_result_set,dm_exec_describe_first_result_set_for_object,dm_exec_input_buffer,dm_exec_plan_attributes,dm_exec_query_plan,dm_exec_query_plan_stats,dm_exec_query_statistics_xml,dm_exec_sql_text,dm_exec_text_query_plan,dm_exec_xml_handles,dm_fts_index_keywords,dm_fts_index_keywords_by_document,dm_fts_index_keywords_by_property,dm_fts_index_keywords_position_by_document,dm_fts_parser,dm_io_virtual_file_stats,dm_logconsumer_cachebufferrefs,dm_logconsumer_privatecachebuffers,dm_logpool_consumers,dm_logpool_sharedcachebuffers,dm_logpoolmgr_freepools,dm_logpoolmgr_respoolsize,dm_logpoolmgr_stats,dm_os_enumerate_filesystem,dm_os_file_exists,dm_os_volume_stats,dm_sql_referenced_entities,dm_sql_referencing_entities,geographycollectionaggregate,geographyconvexhullaggregate,geographyenvelopeaggregate,geographyunionaggregate,geometrycollectionaggregate,geometryconvexhullaggregate,geometryenvelopeaggregate,geometryunionaggregate,ormask
supported-1.0.0=fn_helpcollations,fn_listextendedproperty

#--- Permissions -----

[GRANT]
rule=grant_statement
supported-1.2.0=ALL PRIVILEGES ON OBJECT,SELECT ON OBJECT,INSERT ON OBJECT,UPDATE ON OBJECT,DELETE ON OBJECT,REFERENCES ON OBJECT,EXECUTE ON OBJECT
report_group=Permissions

[REVOKE]
rule=revoke_statement
supported-1.2.0=ALL PRIVILEGES ON OBJECT,SELECT ON OBJECT,INSERT ON OBJECT,UPDATE ON OBJECT,DELETE ON OBJECT,REFERENCES ON OBJECT,EXECUTE ON OBJECT,CASCADE
report_group=Permissions

[DENY]
rule=deny_statement
report_group=Permissions

[ALTER AUTHORIZATION]
rule=alter_authorization
report_group=Permissions

[EXECUTE AS]
rule=execute_as_statement,revert_statement
list=EXECUTE AS USER,EXECUTE AS LOGIN,EXECUTE AS CALLER,REVERT
report_group=Permissions

[SECURITY DEFINER transaction mgmt]
rule=transaction_statement
report_group=Transactions

[OPEN KEY]
rule=open_key
report_group=Encryption

[CLOSE KEY]
rule=close_key
report_group=Encryption

#--- DML -----

[SELECT..PIVOT]
# not supported for 1.0
rule=pivot_clause
report_group=DML

[SELECT..UNPIVOT]
# not supported for 1.0
rule=unpivot_clause
report_group=DML

[SELECT TOP WITH TIES]
rule=top_clause  
report_group=DML

[SELECT TOP PERCENT]
rule=top_clause
list=0,100,NONZERO,VARIABLE,EXPRESSION
supported-1.0.0=100
report_group=DML

[Lateral join]
rule=table_source_item
list=CROSS APPLY,OUTER APPLY
report_group=DML

[T-SQL Outer Join operator]
rule=comparison_operator
list=LEFT OJ,RIGHT OJn
report_group=Operators

[GROUP BY ROLLUP/CUBE (old syntax)]
rule=with_rollup_cube
report_group=DML

[GROUP BY ALL]
rule=query_specification
report_group=DML

[INSERT]
rule=insert_statement
list=VALUES,SELECT,EXECUTE PROCEDURE,EXECUTE SP_EXECUTESQL,EXECUTE(STRING),DEFAULT VALUES,TOP,CTE,OUTPUT,OUTPUT OUTPUT,OPENQUERY,OPENROWSET
supported-1.0.0=VALUES,SELECT,EXECUTE PROCEDURE,CTE,OUTPUT
report_group=DML

[BULK INSERT]
rule=bulk_insert_statement
report_group=DML

[INSERT BULK]
# can only be used with client-side bulk API
rule=insert_bulk_statement
report_group=DML

[UPDATE]
rule=update_statement
list=TOP,CTE,OUTPUT,OUTPUT OUTPUT,OPENQUERY,OPENROWSET,WHERE CURRENT OF
supported-1.0.0=TOP,CTE,OUTPUT
report_group-Cursors=WHERE CURRENT OF
report_group=DML

[DELETE]
rule=update_statement
list=TOP,CTE,OUTPUT,OUTPUT OUTPUT,OPENQUERY,OPENROWSET,WHERE CURRENT OF
supported-1.0.0=TOP,CTE,OUTPUT
report_group-Cursors=WHERE CURRENT OF
report_group=DML

[MERGE]
rule=merge_statement
list=MERGE,TOP,CTE,OUTPUT,OUTPUT OUTPUT
report_group=DML

[DML Table Source]
rule=table_source_item_dml
list=INSERT,UPDATE,DELETE,MERGE
report_group=DML

[TRUNCATE TABLE]
rule=truncate_table
supported-1.0.0=*
report_group=DML

[READTEXT]
rule=readtext_statement
report_group=default

[WRITETEXT]
rule=writetext_statement
report_group=default

[UPDATETEXT]
rule=updatetext_statement
report_group=default

[UPDATE STATISTICS]
rule=update_statistics
report_group=default

#--- SET options -----

[SET, multiple options combined]
rule=set_statement
report_group=SET options
supported-1.0.0=*   

[SET NOCOUNT]
rule=set_special
supported-1.0.0=*    

[SET NOEXEC]
rule=set_special  
supported-1.0.0=OFF  

[SET IDENTITY_INSERT]
rule=set_special
supported-1.0.0=*    

[SET ROWCOUNT]
rule=set_special
list=0,NONZERO,VARIABLE
supported-1.0.0=0    

[SET TRANSACTION ISOLATION LEVEL]
rule=set_special
report_group=Transactions
supported-1.0.0=READ COMMITTED,READ UNCOMMITTED,SNAPSHOT

[SET IMPLICIT_TRANSACTIONS]
rule=set_special
report_group=Transactions
supported-1.0.0=*    

[SET XACT_ABORT]
rule=set_special
report_group=Transactions
supported-1.0.0=*    

[SET ANSI_NULLS]
rule=set_special
supported-1.0.0=*    

[SET ANSI_NULL_DFLT_ON]
rule=set_special
supported-1.0.0=ON

[SET ANSI_NULL_DFLT_OFF]
rule=set_special
supported-1.0.0=OFF

[SET ANSI_PADDING]
rule=set_special
supported-1.0.0=ON

[SET ANSI_WARNINGS]
rule=set_special
supported-1.0.0=ON

[SET ARITHABORT]
rule=set_special
supported-1.0.0=ON

[SET ARITHIGNORE]
rule=set_special
supported-1.0.0=OFF

[SET CURSOR_CLOSE_ON_COMMIT]
rule=set_special
supported-1.0.0=OFF

[SET CONCAT_NULL_YIELDS_NULL]
rule=set_special
supported-1.0.0=*

[SET QUOTED_IDENTIFIER]
rule=set_special
supported-1.0.0=*

[SET FMTONLY]
rule=set_special
default_classification=Ignored

[SET NUMERIC_ROUNDABORT]
rule=set_special
supported-1.0.0=OFF

[SET TEXTSIZE]
rule=set_special
default_classification=Ignored

[SET CONTEXT_INFO]
rule=set_special

[SET STATISTICS]
rule=set_special

[SET OFFSETS]
rule=set_special

[SET DATEFIRST]
rule=set_special
supported-1.0.0=*

[SET DATEFORMAT]
rule=set_special

[SET DEADLOCK_PRIORITY]
rule=set_special
report_group=Transactions

[SET LOCK_TIMEOUT]
rule=set_special
supported-1.2.0=*
report_group=Transactions

[SET LANGUAGE]
rule=set_special,create_login,alter_login
supported-1.0.0=english,us_english

[SET NO_BROWSETABLE]
rule=set_special

#----------------
 
[Login options]
rule=create_login,alter_login
list=SID,DEFAULT_DATABASE,DEFAULT_LANGUAGE,CHECK_EXPIRATION,CHECK_POLICY,CREDENTIAL,PASSWORD,PASSWORD HASHED,MUST_CHANGE,FROM WINDOWS,FROM CERTIFICATE,FROM ASYMMETRIC KEY,ENABLE,DISABLE,ADD CREDENTIAL,DROP CREDENTIAL,NO CREDENTIAL,UNLOCK,NAME,OLD_PASSWORD
supported-1.0.0=PASSWORD,DEFAULT_DATABASE,DEFAULT_LANGUAGE,ENABLE,DISABLE
report_group=Users

[User options]
rule=create_user,alter_user
list=DEFAULT_SCHEMA,ALLOW_ENCRYPTED_VALUE_MODIFICATIONS,FOR LOGIN,WITHOUT LOGIN,FROM CERTIFICATE,FROM ASYMMETRIC KEY,WITH LOGIN,WITH NAME,DEFAULT_LANGUAGE,PASSWORD,OLD_PASSWORD
supported-1.2.0=FOR LOGIN,DEFAULT_SCHEMA
report_group=Users

[CREATE ROLE]
rule=create_db_role
report_group=Users

[ALTER ROLE]
rule=alter_db_role
report_group=Users

[DB role options]
rule=create_db_role,alter_db_role
list=AUTHORIZATION,ADD MEMBER,DROP MEMBER,NAME
report_group=Users

[CREATE SERVER ROLE]
rule=create_server_role
report_group=Users

[ALTER SERVER ROLE]
rule=alter_server_role
supported-1.0.0=SYSADMIN
report_group=Users

[Server role options]
rule=create_server_role,alter_server_role
list=AUTHORIZATION,ADD MEMBER,DROP MEMBER,NAME
supported-1.0.0=ADD MEMBER,DROP MEMBER
report_group=Users

[ALTER SCHEMA]
rule=alter_schema
report_group=Users

[SCHEMA options]
rule=create_schema,alter_schema
list=AUTHORIZATION,CREATE TABLE,CREATE VIEW,GRANT,REVOKE,DENY,TRANSFER,TRANSFER OBJECT,TRANSFER TYPE,TRANSFER XML SCHEMA COLLECTION
supported-1.2.0=AUTHORIZATION
report_group=Users

[SEQUENCE options]
rule=create_sequence,alter_sequence
list=CACHE,NO CACHE
report_group=DDL

[SETUSER]
rule=setuser_statement
report_group=Users

[Miscellaneous objects]
rule=drop_sequence,create_synonym,drop_synonym,create_queue,alter_queue,drop_queue,create_assembly,alter_assembly,drop_assembly,create_aggregate,drop_aggregate,create_application_role,alter_application_role,drop_application_role,create_asymmetric_key,alter_asymmetric_key,drop_asymmetric_key,create_column_encryption_key,alter_column_encryption_key,drop_asymmetric_key,create_column_master_key,create_credential,alter_credential,drop_credential,create_cryptographic_provider,alter_cryptographic_provider,drop_cryptographic_provider,create_contract,drop_contract,create_diagnostic_session,drop_diagnostic_session,create_master_key,alter_master_key,drop_master_key,alter_service_master_key,create_symmetric_key,alter_symmetric_key,drop_symmetric_key,drop_login,create_message_type,alter_message_type,drop_message_type,create_queue,alter_queue,drop_queue,create_service,alter_service,drop_service,create_route,drop_route,create_certificate,alter_certificate,drop_certificate,create_availability_group,alter_availability_group,drop_availability_group,create_external_data_source,alter_external_data_source,drop_external_data_source,create_external_library,alter_external_library,drop_external_library,create_external_resource_pool,alter_external_resource_pool,drop_external_resource_pool,alter_resource_governor,create_workload_group,alter_workload_group,drop_workload_group,create_server_audit_specification,alter_server_audit_specification,drop_server_audit_specification,create_server_audit,alter_server_audit,drop_server_audit,create_fulltext_catalog,alter_fulltext_catalog,drop_fulltext_catalog,create_fulltext_index,alter_fulltext_index,drop_fulltext_index,create_fulltext_stoplist,alter_fulltext_stoplist,drop_fulltext_stoplist,create_remote_service_binding,alter_remote_service_binding,drop_remote_service_binding,create_db_role,alter_db_role,drop_db_role,drop_server_role,create_workload_classifier,drop_workload_classifier
list=SEQUENCE,SYNONYM,QUEUE,ASSEMBLY,AGGREGATE,APPLICATION ROLE,ASYMMETRIC KEY,COLUMN ENCRYPTION KEY,COLUMN MASTER KEY,MASTER KEY,SERVICE MASTER KEY,SYMMETRIC KEY,CREDENTIAL,CRYPTOGRAPHIC PROVIDER,CONTRACT,DIAGNOSTIC SESSION,LOGIN,USER,SERVER ROLE,ROLE,DEFAULT,RULE,ROUTE,QUEUE,SERVICE,MESSAGE TYPE,CERTIFICATE,AVAILABILITY GROUP,EXTERNAL DATA SOURCE,EXTERNAL LIBRARY,EXTERNAL RESOURCE POOL,RESOURCE GOVERNOR,WORKLOAD GROUP,WORKLOAD CLASSIFIER,SERVER AUDIT SPECIFICATION,SERVER AUDIT,FULLTEXT CATALOG,FULLTEXT INDEX,FULLTEXT STOPLIST,REMOTE SERVICE BINDING
supported-1.0.0=SEQUENCE,LOGIN
supported-1.2.0=USER
report_group-DDL=SEQUENCE,SYNONYM,DEFAULT,RULE
report_group-Security=CERTIFICATE,CREDENTIAL,CONTRACT,SERVER AUDIT SPECIFICATION,SERVER AUDIT
report_group-Users=LOGIN,SERVER ROLE,ROLE
report_group-Fulltext Search=FULLTEXT CATALOG,FULLTEXT INDEX,FULLTEXT STOPLIST
report_group-Service Broker=ROUTE,QUEUE,SERVICE,MESSAGE TYPE,REMOTE SERVICE BINDING
report_group-Encryption=ASYMMETRIC KEY,COLUMN ENCRYPTION KEY,COLUMN MASTER KEY,MASTER KEY,SERVICE MASTER KEY,SYMMETRIC KEY,CRYPTOGRAPHIC PROVIDER
report_group=default

[ADD SIGNATURE]
rule=add_signature_statement

[Temporal table]
rule=system_versioning_options

[Service Broker]
rule=conversation_statement

#-----------------------------------------------------------------------------------
#file checksum=db1fd68f
#--- end ---------------------------------------------------------------------------
